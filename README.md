# MLOps FTDA HSE

> –î–æ–º–∞—à–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è –ø–æ –∫—É—Ä—Å—É "–ó–∞–ø—É—Å–∫ ML –º–æ–¥–µ–ª–µ–π –≤ –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–π —Å—Ä–µ–¥–µ" –Ω–∞ –§–¢–∏–ê–î –í–®–≠

### –°–æ—Å—Ç–∞–≤ –∫–æ–º–∞–Ω–¥—ã

- –î–µ–Ω–∏—Å–æ–≤ –°—Ç–µ–ø–∞–Ω
- –¢–∞—Ç–∞—Ä–∏–Ω–æ–≤ –ê—Ä—Ç–µ–º
- –ö–∞—Ä–ª–æ–≤ –í–ª–∞–¥–∏–º–∏—Ä

### –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–µ—Ä–≤–∏—Å, —Ä–µ–∞–ª–∏–∑—É—é—â–∏–π end-to-end —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –∑–∞–ø—É—Å–∫–∞, –æ–±—É—á–µ–Ω–∏—è –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è ML-–º–æ–¥–µ–ª–µ–π.

–°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π:

<div>
  <img src="https://skillicons.dev/icons?i=py" height="40" alt="python" />
  <img src="https://skillicons.dev/icons?i=fastapi" height="40" alt="fastapi" />
  <img src="https://raw.githubusercontent.com/grpc/grpc.io/refs/heads/main/static/img/grpc.svg" height="40" alt="grpc" />
  <img src="https://cdn.simpleicons.org/streamlit/FF4B4B" height="40" alt="streamlit" />
  <img src="https://skillicons.dev/icons?i=docker" height="40" alt="docker" />
  <img src="https://cdn.simpleicons.org/poetry/60A5FA" height="40" alt="poetry" />
</div>

–í–µ—Ç–∫–∏:

- `master` ‚Äì —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è —Å–µ—Ä–≤–∏—Å–∞ —Å –æ—Ç—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∏ –ø–æ–ª–Ω—ã–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º
- `dev-hw1` ‚Äì –≤–µ—Ä—Å–∏—è —Å–µ—Ä–≤–∏—Å–∞ –Ω–∞ –º–æ–º–µ–Ω—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –î–ó-1
- `dev-hw2` ‚Äì –≤–µ—Ä—Å–∏—è —Å–µ—Ä–≤–∏—Å–∞ –Ω–∞ –º–æ–º–µ–Ω—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –î–ó-2
- `dev-hw3` ‚Äì –≤–µ—Ä—Å–∏—è —Å–µ—Ä–≤–∏—Å–∞ –Ω–∞ –º–æ–º–µ–Ω—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –î–ó-3

### –î–æ—Å—Ç—É–ø–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

–°–µ—Ä–≤–∏—Å –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Ä–∞–±–æ—Ç—ã —Å ML –º–æ–¥–µ–ª—è–º–∏. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Å–ª–µ–¥—É—é—â–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:

- –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∫–ª–∞—Å—Å–æ–≤ –º–æ–¥–µ–ª–µ–π, –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
- –û–±—É—á–µ–Ω–∏–µ —Å –∑–∞–¥–∞–Ω–Ω—ã–º–∏ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –æ–±—É—á–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π
- –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –º–æ–¥–µ–ª–∏
- –ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
- –£–¥–∞–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
- –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ (–ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–µ—Ç—Å—è –µ–µ —É–¥–∞–ª–µ–Ω–∏–µ –∏ –Ω–æ–≤—ã–π –∑–∞–ø—É—Å–∫ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –æ–±—É—á–µ–Ω–∏—è, –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏ –º–æ–¥–µ–ª–µ–π
  –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Ö—ç—à –æ—Ç –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ –¥–∞–Ω–Ω—ã—Ö)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Ä–∞–±–æ—Ç—ã —Å–µ—Ä–≤–∏—Å–∞

–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –Ω–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ç–æ–ª—å–∫–æ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ.

### –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É

0. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ python >=3.10, <=3.12 –∏ poetry –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏

1. –°–∫–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å –ø—Ä–æ–µ–∫—Ç–æ–º

```bash
git clone https://github.com/sd-denisoff/mlops_hse_2024.git
cd mlops_hse_2024
```

2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
poetry install
```

3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä

FastAPI:
```bash
poetry run uvicorn server.rest.app:app --port 8080 --reload
```

gRPC:
```bash
poetry run python3 server/grpc/server.py
```

–ê–¥—Ä–µ—Å Swagger –≤ —Å–ª—É—á–∞–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ FastAPI: http://localhost:8000/docs

4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

```bash
poetry run streamlit run gui/üèö_–ì–ª–∞–≤–Ω–∞—è.py
```

–ê–¥—Ä–µ—Å –¥–∞—à–±–æ—Ä–¥–∞: http://localhost:8501

### –ó–∞–ø—É—Å–∫ –≤—Å–µ–≥–æ —á–µ—Ä–µ–∑ Docker

1. –î–æ–±–∞–≤—å—Ç–µ —Ñ–∞–π–ª `.env` —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```
MINIO_ROOT_USER=user
MINIO_ROOT_PASSWORD=password
MINIO_PORT=9000
MINIO_BUCKET=trainer-bucket

MLFLOW_PORT=5001
MLFLOW_DB_PATH=sqlite:///ml_flow.db
MLFLOW_ARTIFACTS_PATH=/mlflow/artifacts
```

2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å

```bash
docker build -f Dockerfile -t trainer-base:latest .
docker-compose up --build
```

3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ MLflow

```bash
docker compose -f mlflow-docker-compose.yml up --build
```

–ê–¥—Ä–µ—Å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞: http://localhost:5001


### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ó–∞–ø—É—Å–∫ unit-—Ç–µ—Å—Ç–æ–≤:
```bash
pytest unit_tests
```

–ó–∞–ø—É—Å–∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ (–ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–∞ —Å MinIO –ø–æ [–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏](#–∑–∞–ø—É—Å–∫-–≤—Å–µ–≥–æ-—á–µ—Ä–µ–∑-docker)):
```bash
pytest integration_tests
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞

```bash
poetry run pylint .
poetry run black --check --extend-exclude='/server/grpc/*' . 
```
